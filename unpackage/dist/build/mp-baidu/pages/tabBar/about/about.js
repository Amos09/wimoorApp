"use strict";var e=require("../../../common/vendor.js"),n=require("../../../api/sys/login.js");require("../../../common/request.js");const t={data:()=>({placeholderStyle:"color:#757575;font-size:14px",styles:{color:"#000",borderColor:"#747474"},type:"center",tableData:[],curuser:{account:""}}),onShow(){this.getOpenUserlist()},methods:{getOpenUserlist(){var t=this;n.loginApi.getOpenUserlist({openid:e.index.getStorageSync("openid")}).then((n=>{t.tableData=n,t.curuser=e.index.getStorageSync("currentuser")}))},unbindAccount(t){let o=this;e.index.showModal({title:"提示",content:"解绑后需重新绑定,确认解除吗？",success:function(a){a.confirm&&n.loginApi.unbindWechat({ftype:"app",account:t,openid:e.index.getStorageSync("openid")}).then((n=>{1==n.isOk?(e.index.showToast({title:n.msg,icon:"none",duration:2e3}),o.curuser.account==t?(o.tableData=[],o.getOpenUserlist(),e.index.removeStorageSync("currentuser"),e.index.removeStorageSync("JSessionId"),e.index.navigateTo({url:"/pages/sys/validate/index"})):(o.tableData=[],o.getOpenUserlist())):e.index.showToast({title:n.msg,icon:"none",duration:2e3})}))}})},changeAccount(t){let o=this;var a=e.index.getStorageSync("JSessionId"),c=e.index.getStorageSync("openid");n.loginApi.changeLoginWechatApp({openid:c,account:t,jsessionid:a}).then((n=>{n&&(e.index.showToast({icon:"none",duration:2e3,title:"切换账号成功！"}),e.index.setStorageSync("currentuser",n.currentuser),o.curuser=n.currentuser,o.getOpenUserlist())}))},goValidatePage(){e.index.navigateTo({url:"/pages/sys/validate/index?ftype=app"})}}};if(!Array){(e.resolveComponent("uni-th")+e.resolveComponent("uni-tr")+e.resolveComponent("uni-td")+e.resolveComponent("uni-table"))()}Math||((()=>"../../../uni_modules/uni-table/components/uni-th/uni-th.js")+(()=>"../../../uni_modules/uni-table/components/uni-tr/uni-tr.js")+(()=>"../../../uni_modules/uni-table/components/uni-td/uni-td.js")+(()=>"../../../uni_modules/uni-table/components/uni-table/uni-table.js"))();var o=e._export_sfc(t,[["render",function(n,t,o,a,c,i){return e.e({a:c.curuser.account},c.curuser.account?{b:e.t(c.curuser.account)}:{},{c:e.p({align:"center"}),d:e.p({align:"center"}),e:c.tableData.length>0},c.tableData.length>0?{f:e.f(c.tableData,((n,t,o)=>e.e({a:t,b:e.t(n.account),c:"a9414ecc-5-"+o+",a9414ecc-4-"+o,d:e.o((e=>i.unbindAccount(n.account))),e:c.curuser.account!=n.account},c.curuser.account!=n.account?{f:e.o((e=>i.changeAccount(n.account)))}:{},{g:"a9414ecc-6-"+o+",a9414ecc-4-"+o,h:"a9414ecc-4-"+o+",a9414ecc-0"}))),g:e.p({align:"center"}),h:e.p({align:"center"})}:{},{i:e.p({border:!0,stripe:!0,emptyText:"暂无更多数据"}),j:e.o((e=>i.goValidatePage()))})}]]);swan.createPage(o);
