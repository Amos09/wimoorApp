"use strict";const t=require("../../../common/vendor.js"),e=require("../../../api/erp/purchase/purchase.js");require("../../../utils/request.js"),require("../../../store/index.js");const s={data:()=>({search:"",placeholderStyle:"color:#ffa400;font-size:14px",styles:{color:"#ffa400",borderColor:"#ffa400"},listData:[],last_id:"",reload:!1,status:"more",contentText:{contentdown:"上拉加载更多",contentrefresh:"加载中",contentnomore:"没有更多"},ftype:"sku",offset:1,index:0,items:["SKU","订单号","运单号"],values:["sku","order","logistics"]}),onLoad(){this.getList()},onPullDownRefresh(){this.reload=!0,this.last_id="",this.getList()},onReachBottom(){this.status="more",this.getList()},methods:{searchOrder(t){this.listData=[],this.offset=1,this.reload=!0,this.search=t,this.index=1,this.ftype="order",this.getList()},suppliernameFuc:t=>null==t||null==t||""==t?"--":t,paystatusFuc:t=>"1"==t||1==t?"已付款":"未付款",deliverydateFuc:t=>null!=t&&null!=t&&""!=t?t.split(" ")[0]:"--",statusFuc:t=>0==t||"0"==t?"已退回":1==t||"1"==t?"待审核":2==t||"2"==t?"执行中":3==t||"3"==t?"已完成":void 0,refreshtab(){this.offset=1,this.search="",this.ftype="sku",this.index=0,this.reload=!0,this.getList()},scanHandler(){var e=this;t.index.scanCode({success:function(t){t.result&&(e.listData=[],e.offset=1,e.index=2,e.ftype="logistics",e.reload=!0,e.search=t.result,e.getList())}})},onchange(t){this.index=t.detail.value,this.ftype=this.values[this.index],this.listData=[],this.offset=1,this.reload=!0,this.getList()},input(t){this.listData=[],this.offset=1,this.reload=!0,this.search=t,this.getList()},getList(){this.last_id&&(this.status="loading"),e.purchaseApi.list({sort:"sku",order:"desc",offset:this.offset,limit:10,auditstatus:"4",ftype:this.ftype,datetype:"createdate",search:this.search,minid:this.last_id}).then((t=>{if(t&&t.records&&t.records.length>0){let e=t.records;e.length>0?(this.listData=this.reload?e:this.listData.concat(e),this.last_id=e[e.length-1].id,this.reload=!1,e.length<10&&(this.status="nomore"),this.offset=this.offset+1):(this.status="nomore",this.reload=!1)}else this.status="nomore",this.reload=!1}))},goMaterialInfoPage(e){t.index.navigateTo({url:"../material/material?materialid="+e})},goDetail:function(e){t.index.navigateTo({url:"./receive?detailData="+encodeURIComponent(JSON.stringify(e))})},aderror(t){}}};if(!Array){(t.resolveComponent("uni-easyinput")+t.resolveComponent("uni-icons")+t.resolveComponent("uni-load-more"))()}Math||((()=>"../../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js"))();const i=t._export_sfc(s,[["render",function(e,s,i,a,o,n){return{a:t.t(o.items[o.index]),b:t.o(((...t)=>n.onchange&&n.onchange(...t))),c:o.index,d:o.items,e:t.o(n.refreshtab),f:t.o(n.input),g:t.o((t=>o.search=t)),h:t.p({styles:o.styles,placeholderStyle:o.placeholderStyle,suffixIcon:"loop",placeholder:"请输入内容自动查询",modelValue:o.search}),i:t.o(n.scanHandler),j:t.p({color:"#FFA400",type:"scan",size:"28"}),k:t.f(o.listData,((e,s,i)=>t.e({a:t.o((t=>n.goMaterialInfoPage(e.materialid))),b:e.image,c:t.t(e.sku),d:"1"==e.issfg},(e.issfg,{}),{e:t.t(e.amount),f:t.t(n.statusFuc(e.auditstatus)),g:t.t(n.deliverydateFuc(e.deliverydate)),h:t.t(n.paystatusFuc(e.paystatus)),i:t.t(n.suppliernameFuc(e.suppliername)),j:t.t(e.number),k:"7314a949-2-"+i,l:t.o((t=>n.searchOrder(e.number))),m:t.t(e.creatorname),n:t.t(e.createdate),o:t.o((t=>n.goDetail(e))),p:s}))),l:t.p({color:"#787878",type:"search",size:"12"}),m:t.p({status:o.status,"icon-size":16,"content-text":o.contentText})}}]]);wx.createPage(i);
