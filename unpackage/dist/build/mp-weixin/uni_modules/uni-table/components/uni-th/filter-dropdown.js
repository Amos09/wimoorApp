"use strict";var e=require("../../../../common/vendor.js");const t={reset:"重置",search:"搜索",submit:"确定",filter:"筛选",gt:"大于等于",lt:"小于等于",date:"日期范围"},i="select",s="search",a="range",l="date",h="timestamp",r={name:"FilterDropdown",emits:["change"],components:{checkBox:()=>"../uni-tr/table-checkbox.js"},options:{virtualHost:!0},props:{filterType:{type:String,default:i},filterData:{type:Array,default:()=>[]},mode:{type:String,default:"default"},map:{type:Object,default:()=>({text:"text",value:"value"})}},computed:{canReset(){return this.isSearch?this.filterValue.length>0:this.isSelect?this.checkedValues.length>0:this.isRange?this.gtValue.length>0&&this.ltValue.length>0:!!this.isDate&&this.dateSelect.length>0},isSelect(){return this.filterType===i},isSearch(){return this.filterType===s},isRange(){return this.filterType===a},isDate(){return this.filterType===l||this.filterType===h}},watch:{filters(e){this._copyFilters()},indeterminate(e){this.isIndeterminate=e}},data:()=>({resource:t,enabled:!0,isOpened:!1,dataList:[],filterValue:"",checkedValues:[],gtValue:"",ltValue:"",dateRange:[],dateSelect:[]}),created(){this._copyFilters()},methods:{_copyFilters(){let e=JSON.parse(JSON.stringify(this.filterData));for(let t=0;t<e.length;t++)void 0===e[t].checked&&(e[t].checked=!1);this.dataList=e},openPopup(){this.isOpened=!0,this.isDate&&this.$nextTick((()=>{this.dateRange.length||this.resetDate(),this.$refs.datetimepicker.show()}))},closePopup(){this.isOpened=!1},handleClose(e){this.closePopup()},resetDate(){let e=(new Date).toISOString().split("T")[0];this.dateRange=[e+" 0:00:00",e+" 23:59:59"]},onDropdown(e){this.openPopup()},onItemClick(e,t){let i=this.dataList,s=i[t];void 0===s.checked?i[t].checked=!0:i[t].checked=!s.checked;let a=[];for(let l=0;l<i.length;l++){const e=i[l];e.checked&&a.push(e.value)}this.checkedValues=a},datetimechange(e){this.closePopup(),this.dateRange=e,this.dateSelect=e,this.$emit("change",{filterType:this.filterType,filter:e})},timepickerclose(e){this.closePopup()},handleSelectSubmit(){this.closePopup(),this.$emit("change",{filterType:this.filterType,filter:this.checkedValues})},handleSelectReset(){if(this.canReset){var e=this.dataList;for(let t=0;t<e.length;t++){let i=e[t];this.$set(i,"checked",!1)}this.checkedValues=[],this.handleSelectSubmit()}},handleSearchSubmit(){this.closePopup(),this.$emit("change",{filterType:this.filterType,filter:this.filterValue})},handleSearchReset(){this.canReset&&(this.filterValue="",this.handleSearchSubmit())},handleRangeSubmit(e){this.closePopup(),this.$emit("change",{filterType:this.filterType,filter:!0===e?[]:[parseInt(this.gtValue),parseInt(this.ltValue)]})},handleRangeReset(){this.canReset&&(this.gtValue="",this.ltValue="",this.handleRangeSubmit(!0))}}};if(!Array){(e.resolveComponent("check-box")+e.resolveComponent("uni-datetime-picker"))()}Math;var c=e._export_sfc(r,[["render",function(t,i,s,a,l,h){return e.e({a:h.isSelect||h.isRange},h.isSelect||h.isRange?{b:h.canReset?1:""}:{},{c:h.isSearch},h.isSearch?{d:h.canReset?1:""}:{},{e:h.isDate},h.isDate?{f:h.canReset?1:""}:{},{g:e.o(((...e)=>h.onDropdown&&h.onDropdown(...e))),h:l.isOpened},l.isOpened?{i:e.o(((...e)=>h.handleClose&&h.handleClose(...e)))}:{},{j:l.isOpened},l.isOpened?e.e({k:h.isSelect},h.isSelect?{l:e.f(l.dataList,((t,i,a)=>({a:"4ad8393d-0-"+a,b:e.p({checked:t.checked}),c:e.t(t[s.map.text]),d:e.s(t.styleIconText),e:i,f:e.o((e=>h.onItemClick(e,i)))})))}:{},{m:h.isSelect},h.isSelect?{n:e.t(l.resource.reset),o:h.canReset?"":1,p:e.o(((...e)=>h.handleSelectReset&&h.handleSelectReset(...e))),q:e.t(l.resource.submit),r:e.o(((...e)=>h.handleSelectSubmit&&h.handleSelectSubmit(...e)))}:{},{s:h.isSearch},h.isSearch?{t:l.filterValue,v:e.o((e=>l.filterValue=e.detail.value))}:{},{w:h.isSearch},h.isSearch?{x:e.t(l.resource.search),y:e.o(((...e)=>h.handleSearchSubmit&&h.handleSearchSubmit(...e))),z:e.t(l.resource.reset),A:h.canReset?"":1,B:e.o(((...e)=>h.handleSearchReset&&h.handleSearchReset(...e)))}:{},{C:h.isRange},h.isRange?{D:e.t(l.resource.gt),E:l.gtValue,F:e.o((e=>l.gtValue=e.detail.value)),G:e.t(l.resource.lt),H:l.ltValue,I:e.o((e=>l.ltValue=e.detail.value))}:{},{J:h.isRange},h.isRange?{K:e.t(l.resource.reset),L:h.canReset?"":1,M:e.o(((...e)=>h.handleRangeReset&&h.handleRangeReset(...e))),N:e.t(l.resource.submit),O:e.o(((...e)=>h.handleRangeSubmit&&h.handleRangeSubmit(...e)))}:{},{P:h.isDate},h.isDate?{Q:e.sr("datetimepicker","4ad8393d-1"),R:e.o(h.datetimechange),S:e.o(h.timepickerclose),T:e.p({value:l.dateRange,type:"datetimerange","return-type":"timestamp"})}:{},{U:e.o((()=>{}))}):{})}]]);wx.createComponent(c);
