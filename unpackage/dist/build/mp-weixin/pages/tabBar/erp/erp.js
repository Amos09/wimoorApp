"use strict";var e=require("../../../common/vendor.js"),s=require("../../../api/sys/login.js");require("../../../common/request.js");const i={props:{hasLeftWin:{type:Boolean},leftWinActive:{type:String}},data:()=>({list:[{id:"inventory",name:"库存管理",open:!1,pages:[{name:"仓库管理",url:"/pages/erp/warehouse/warehouse"}]},{pages:[{name:"商品补货",url:"/pages/erp/ship/ship"},{name:"商品采购",url:"/pages/erp/purchase/purchase"},{name:"产品管理",url:"/pages/erp/material/material"}]}]}),onShareAppMessage:()=>({title:"欢迎体验wimoor移动端",path:"/pages/tabBar/erp/erp"}),onLoad(){this.validateUser()},onNavigationBarButtonTap(s){e.index.navigateTo({url:"/pages/about/about"})},methods:{scanCode(){e.index.scanCode({success:function(s){if(s.result){let i=s.result;if(i.indexOf("wxwarehouseshelf/")>0){let i={shelfid:s.result.split("wxwarehouseshelf/")[1]};e.index.navigateTo({url:"/pages/erp/warehouse/inventory/addshelf?detailDate="+encodeURIComponent(JSON.stringify(i))})}else if(i.indexOf("wxsc/")>0){let i=s.result.split("wxsc/")[1];e.index.navigateTo({url:"/pages/erp/ship/quota/index?shipmentid="+i})}}}})},validateUser(){e.index.login({success(i){i.code?s.loginApi.loginWechat({code:i.code}).then((s=>{if(s&&"isfail"!=s.status){let i=s.jsessionid,t=s.currentuser;e.index.setStorageSync("JSessionId",i),e.index.setStorageSync("currentuser",t),e.index.setStorageSync("userlist",s.userlist),e.index.setStorageSync("openid",s.openid)}else s.openid?(e.index.setStorageSync("openid",s.openid),e.index.setStorageSync("JSessionId",s.jsessionid),e.index.navigateTo({url:"../../sys/validate/index"})):e.index.showToast({title:"微信账号异常!!!",icon:"none",duration:2e3})})):e.index.showToast({title:"登录失败！"+i.errMsg,icon:"none",duration:2e3})}})},triggerCollapse(e,s){if(this.list[e].pages)for(var i=0;i<this.list.length;++i)this.list[i].open=e===i&&!this.list[i].open;else this.goDetailPage("",this.list[e].url)},goDetailPage(s){e.index.navigateTo({url:s})}}};if(!Array){e.resolveComponent("uni-icons")()}Math;var t=e._export_sfc(i,[["render",function(s,i,t,a,n,o){return e.e({a:!t.hasLeftWin},t.hasLeftWin?{}:{b:e.o(o.scanCode),c:e.p({color:"#ffa400",type:"scan",size:"34"}),d:e.o(((...e)=>o.scanCode&&o.scanCode(...e))),e:e.p({color:"#00aaff",type:"list",size:"34"}),f:e.p({color:"#ff5500",type:"upload",size:"34"})},{g:e.o((e=>o.goDetailPage("/pages/erp/purchase/purchase"))),h:e.p({type:"shop",size:"34",color:"#0000ff"})})}]]);i.__runtimeHooks=2,wx.createPage(t);
