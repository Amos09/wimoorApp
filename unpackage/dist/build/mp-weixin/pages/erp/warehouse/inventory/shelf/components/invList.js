"use strict";const e=require("../../../../../../common/vendor.js"),a=require("../../../../../../api/erp/warehouse/warehouseApi.js");require("../../../../../../utils/request.js"),require("../../../../../../store/index.js"),Math||t();const t=()=>"../../../../../../components/globaltable/checktable.js",r={__name:"invList",props:{editable:!1},emits:["submit"],setup(r,{expose:n,emit:i}){const o=r,u=e.ref(t),l=e.reactive({queryParam:{},tableOption:{key:"materialid",submitTitle:"下架"},tableData:{records:[],total:0}}),{tableData:s,queryParam:m,tableOption:d}=e.toRefs(l),{editable:c}=e.toRefs(o);function f(e){return null==e||""==e||null==e?"--":e}function h(t){var r=[];t.forEach((function(e,a){if(e&&e.amount){var t={};t.materialid=e.materialid,t.quantity=e.amount,t.opt=1,t.formtype="direct",t.shelfid=l.queryParam.shelfid,r.push(t)}})),e.index.showModal({title:"提示",content:"请确认是否操作?",success:function(t){t.confirm&&a.warehouseApi.invSub(r).then((a=>{e.index.showToast({title:"下架成功",icon:"none",duration:3e3}),i("submit",a)}))}})}function b(e){a.warehouseApi.getShelfInventoryList(e).then((e=>{e?e.records&&(e.records.forEach((e=>{e.amount=e.quantity})),l.tableData.records=e.records,l.tableData.total=e.total):(l.tableData.records=[],l.tableData.total=0)}))}return n({refreshList:function(e,a,t,r){l.queryParam={search:"",shelfid:"",addressid:e,allchildren:"false",materialid:"",searchtype:"sku",order:"desc",sort:"quantity"},l.queryParam.shelfid=a,l.queryParam.materialid=r,t?l.queryParam.search=t:(l.queryParam.search="",l.queryParam.searchtype=null),u.value.loadTable(l.queryParam)}}),(a,t)=>({a:e.w((({row:a},t,r)=>{return e.e({a:e.o((t=>{return r=a.materialid,void e.index.navigateTo({url:"../../../material/material?materialid="+r});var r})),b:a.image,c:e.t((n=a.name,null==n||""==n||null==n?"--":n)),d:e.t(f(a.sku)),e:e.t(a.quantity)},e.unref(c)?{f:a.amount,g:e.o((e=>function(e){e.amount||(e.amount="")}(a))),h:e.o((e=>function(e){e.amount&&e.amount!=e.quantity?u.value.checkByKey(e.materialid):e.amount||(e.amount=e.quantity)}(a))),i:a.amount,j:e.o(e.m((e=>a.amount=e.detail.value),{number:!0}))}:{},{k:r,l:t});var n}),{name:"d",path:"a",vueId:"0efdaed0-0"}),b:e.unref(c),c:e.sr(u,"0efdaed0-0",{k:"globalTableRef"}),d:e.o(h),e:e.o(b),f:e.p({option:e.unref(d),tableData:e.unref(s)})})}};wx.createComponent(r);
