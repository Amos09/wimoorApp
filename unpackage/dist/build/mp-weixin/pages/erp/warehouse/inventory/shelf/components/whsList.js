"use strict";const a=require("../../../../../../common/vendor.js"),e=require("../../../../../../api/erp/warehouse/warehouseApi.js");require("../../../../../../utils/request.js"),require("../../../../../../store/index.js"),Math||t();const t=()=>"../../../../../../components/globaltable/checktable.js",r={__name:"whsList",emits:["submit"],setup(r,{expose:o,emit:u}){const i=a.ref(t),n=a.reactive({queryParam:{},tableOption:{key:"id",submitTitle:"上架"},tableData:{records:[],total:0},optamount:""}),{tableData:l,queryParam:m,tableOption:s}=a.toRefs(n);function c(a){return null==a||""==a||null==a?"--":a}function d(t){var r=[];t.forEach((function(a,e){var t={};a&&a.amount&&(t.materialid=a.id,t.quantity=a.amount,t.opt=1,t.formtype="direct",t.shelfid=n.queryParam.shelfid,n.queryParam.materialid&&(n.queryParam.formid&&(t.formid=n.queryParam.formid),n.queryParam.formtype&&(t.formtype=n.queryParam.formtype)),r.push(t))})),a.index.showModal({title:"提示",content:"请确认是否操作?",success:function(t){t.confirm?e.warehouseApi.invAdd(r).then((e=>{a.index.showToast({title:"上架成功",icon:"none",duration:3e3}),u("submit",e)})):t.cancel}})}function f(a){e.warehouseApi.getShelfList(a).then((a=>{a?a.records&&(a.records.forEach((a=>{n.queryParam.materialid&&n.optamount?a.amount=n.optamount:a.amount=a.quantity})),n.tableData.records=a.records,n.tableData.total=a.total):(n.tableData.records=[],n.tableData.total=0)}))}return o({refreshList:function(a,e,t,r,o,u,l){n.queryParam={search:"",shelfid:"",addressid:"",allchildren:"false",materialid:"",searchtype:"sku"},n.queryParam.addressid=a,n.queryParam.shelfid=e,n.queryParam.materialid=r,n.queryParam.formid=u,n.queryParam.formtype=l,n.optamount=o,t?n.queryParam.search=t:(n.queryParam.search="",n.queryParam.searchtype=null),i.value.loadTable(n.queryParam)}}),(e,t)=>({a:a.w((({row:e},t,r)=>{return{a:a.o((t=>{return r=e.id,void a.index.navigateTo({url:"../../../material/material?materialid="+r});var r})),b:e.image,c:a.t((o=e.name,null==o||""==o||null==o?"--":o)),d:a.t(c(e.sku)),e:a.t(e.quantity),f:e.amount,g:a.o((a=>function(a){a.amount||(a.amount="")}(e))),h:a.o((a=>function(a){a.amount&&a.amount!=a.fulfillable?i.value.checkByKey(a.id):a.amount||(a.amount=a.fulfillable)}(e))),i:e.amount,j:a.o(a.m((a=>e.amount=a.detail.value),{number:!0})),k:r,l:t};var o}),{name:"d",path:"a",vueId:"860cfcbe-0"}),b:a.sr(i,"860cfcbe-0",{k:"globalTableRef"}),c:a.o(d),d:a.o(f),e:a.p({option:a.unref(s),submitTitle:"上架",tableData:a.unref(l)})})}};wx.createComponent(r);
